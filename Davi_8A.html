<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jogo da Forca - Consci√™ncia Negra</title>
    <style>
        :root {
            --deep: #0f172a;
            --gold: #f2b33d;
            --sunset: #f27d3d;
            --light: #fffbeb;
            --wrong: #ef4444;
            --correct: #34d399;
            --hint-bg: rgba(255,255,255,0.12);
        }
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1e293b, #0f172a);
            color: var(--light);
            height: 100vh;
            overflow: hidden;
        }
        /* Bot√£o Voltar */
        .back-link {
            position: fixed;
            top: 58px;
            left: 18px;
            z-index: 120;
            display: inline-block;
            background: linear-gradient(45deg, var(--gold), var(--sunset));
            color: var(--deep);
            text-decoration: none;
            padding: 10px 14px;
            border-radius: 999px;
            font-weight: 800;
            font-size: 0.95rem;
            box-shadow: 0 8px 20px rgba(242,179,61,0.25);
            transition: transform 0.18s ease, box-shadow 0.18s ease, opacity 0.18s ease;
        }
        .back-link:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 28px rgba(242,179,61,0.4);
        }
        /* Cr√©dito vertical */
        .credit {
            position: fixed;
            left: 12px;
            bottom: 40%;
            transform: rotate(-90deg);
            transform-origin: left center;
            font-size: 0.85rem;
            font-weight: 600;
            color: rgba(255,255,255,0.6);
            letter-spacing: 2px;
            z-index: 110;
        }
        /* Cabe√ßalho */
        .header {
            position: fixed;
            top: 0; left: 0; right: 0;
            height: 45px;
            background: rgba(15,23,42,0.9);
            backdrop-filter: blur(12px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 12px;
            z-index: 100;
            border-bottom: 2px solid var(--gold);
        }
        .level-info {
            font-size: 0.95rem;
            font-weight: bold;
            color: var(--gold);
        }
        .xp-bar {
            width: 160px;
            height: 10px;
            background: #334155;
            border-radius: 5px;
            overflow: hidden;
            margin-left: 8px;
        }
        .xp-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--gold), var(--sunset));
            width: 0%;
            transition: width 0.8s ease;
        }
        .xp-text {
            font-size: 0.75rem;
            margin-left: 6px;
            color: var(--light);
        }
        /* Bot√£o Pr√≥xima */
        .next-btn {
            position: fixed;
            top: 18px;
            right: 20px;
            z-index: 110;
            background: linear-gradient(45deg, var(--gold), var(--sunset));
            color: var(--deep);
            padding: 10px 24px;
            border-radius: 999px;
            font-weight: 800;
            font-size: 1rem;
            border: none;
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(242,179,61,0.35);
            transition: all 0.2s;
            display: none;
        }
        .next-btn:hover { transform: translateY(-3px); box-shadow: 0 12px 28px rgba(242,179,61,0.5); }
        
        /* Bot√£o Salvar Score */
        .save-score-btn {
            position: fixed;
            top: 68px;
            right: 30px;
            z-index: 110;
            background: rgba(255,255,255,0.1);
            border: 2px solid var(--gold);
            color: var(--gold);
            padding: 8px 16px;
            border-radius: 999px;
            font-weight: 700;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .save-score-btn:hover {
            background: var(--gold);
            color: var(--deep);
            transform: translateY(-2px);
        }
        /* Boosts */
        .boosts {
            display: flex;
            gap: 12px;
            margin: 8px 0;
            flex-wrap: wrap;
            justify-content: center;
        }
        .boost-btn {
            background: var(--hint-bg);
            border: 2px solid var(--gold);
            color: white;
            padding: 6px 12px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 110px;
        }
        .boost-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            border-color: #475569;
        }
        .boost-btn:hover:not(:disabled) {
            background: var(--gold);
            color: var(--deep);
            transform: scale(1.08);
        }
        /* Jogo */
        #game {
            display: none;
            width: 100%;
            height: 100%;
            padding: 50px 12px 12px;
            text-align: center;
        }
        .hangman-container {
            max-width: 1000px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .hint {
            font-size: 1rem;
            margin: 5px 0;
            color: var(--gold);
            font-style: italic;
            max-width: 90%;
        }
        /* PALAVRA DESCEU E N√ÉO SOBREPOE MAIS A FORCA */
        .word-display {
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            letter-spacing: 0.08em;
            margin: 10px 0 10px 0;
            font-weight: bold;
            word-spacing: 0.12em;
            white-space: nowrap;
            position: relative;
            top: 0;
        }
        .keyboard {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 5px;
            margin-top: 5px;
            max-width: 600px;
            width: 95%;
        }
        .key {
            background: rgba(255,255,255,0.12);
            border: 2px solid var(--gold);
            color: white;
            font-size: clamp(0.9rem, 2.5vw, 1.2rem);
            font-weight: bold;
            padding: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
        }
        .key:hover { background: var(--gold); color: var(--deep); transform: scale(1.08); }
        .key:active { transform: scale(0.95); }
        .key.used { background: #475569; border-color: #475569; cursor: not-allowed; }
        .key.correct { background: var(--correct); border-color: var(--correct); }
        .key.wrong { background: var(--wrong); border-color: var(--wrong); }
        .hangman-svg { width: 160px; height: 200px; margin: 3px 0; }
        .message {
            font-size: 1.3rem;
            margin-top: 5px;
            font-weight: bold;
            min-height: 40px;
        }
        
        /* Modal para entrada de nome */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 200;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #1e293b, #0f172a);
            padding: 2rem;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            border: 2px solid var(--gold);
            box-shadow: 0 20px 40px rgba(0,0,0,0.5);
        }
        
        .modal h2 {
            color: var(--gold);
            margin-bottom: 1rem;
            font-size: 1.8rem;
        }
        
        .name-input {
            width: 100%;
            padding: 12px;
            margin: 1rem 0;
            border: 2px solid var(--gold);
            border-radius: 10px;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 1.2rem;
            text-align: center;
        }
        
        .name-input::placeholder {
            color: rgba(255,255,255,0.6);
        }
        
        .modal-btn {
            background: linear-gradient(45deg, var(--gold), var(--sunset));
            color: var(--deep);
            border: none;
            padding: 12px 30px;
            margin: 0 10px;
            border-radius: 999px;
            font-weight: 800;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(242,179,61,0.4);
        }
        
        /* Ranking */
        .ranking {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 1.5rem;
            margin: 1rem 0;
            border: 2px solid var(--gold);
            max-height: 300px;
            overflow-y: auto;
        }
        
        .ranking h3 {
            color: var(--gold);
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }
        
        .ranking-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 12px;
            margin: 5px 0;
            background: rgba(255,255,255,0.08);
            border-radius: 8px;
            border-left: 4px solid var(--gold);
        }
        
        .ranking-item.top-3 {
            background: rgba(242,179,61,0.15);
            border-left-color: var(--sunset);
        }
        
        .ranking-position {
            font-weight: bold;
            color: var(--gold);
            min-width: 30px;
        }
        
        .ranking-name {
            flex: 1;
            text-align: left;
            margin-left: 10px;
        }
        
        .ranking-score {
            font-weight: bold;
            color: var(--sunset);
        }
        
        /* Bot√£o ranking no menu */
        .ranking-btn {
            background: rgba(255,255,255,0.1);
            border: 2px solid var(--gold);
            color: var(--gold);
            padding: 15px 40px;
            margin-top: 20px;
            border-radius: 999px;
            font-weight: 700;
            font-size: 1.4rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .ranking-btn:hover {
            background: var(--gold);
            color: var(--deep);
            transform: scale(1.05);
        }
    </style>
</head>
<body>

    <a class="back-link" href="index.html">Voltar</a>
    <div class="credit">Davi 8A</div>

    <!-- MENU -->
    <div id="menu" style="height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;">
        <h1 style="font-size:5rem;background:linear-gradient(45deg,var(--gold),var(--sunset));-webkit-background-clip:text;-webkit-text-fill-color:transparent;">
            Jogo da Forca
        </h1>
        <p style="font-size:1.6rem;margin:30px 0;">Consci√™ncia Negra: Hist√≥ria & Folclore</p>
        <button class="play" id="play-btn" style="padding:20px 60px;font-size:1.8rem;background:linear-gradient(45deg,var(--gold),var(--sunset));color:var(--deep);border:none;border-radius:999px;cursor:pointer;">PLAY</button>
        <button class="ranking-btn" id="ranking-btn">üèÜ RANKING</button>
    </div>

    <!-- MODAL DE ENTRADA DE NOME -->
    <div id="name-modal" class="modal">
        <div class="modal-content">
            <h2>üéâ Parab√©ns!</h2>
            <p>Voc√™ alcan√ßou o n√≠vel <span id="final-level">1</span>!</p>
            <p>Digite seu nome para salvar no ranking:</p>
            <input type="text" id="player-name" class="name-input" placeholder="Seu nome aqui..." maxlength="15">
            <div style="margin-top: 1.5rem;">
                <button class="modal-btn" id="save-score">Salvar</button>
                <button class="modal-btn" id="skip-save" style="background:rgba(255,255,255,0.2);">Pular</button>
            </div>
        </div>
    </div>

    <!-- MODAL DE RANKING -->
    <div id="ranking-modal" class="modal">
        <div class="modal-content">
            <h2>üèÜ Ranking dos Mestres</h2>
            <div id="ranking-list" class="ranking">
                <!-- Rankings ser√£o inseridos aqui -->
            </div>
            <button class="modal-btn" id="close-ranking">Fechar</button>
        </div>
    </div>

    <!-- JOGO -->
    <div id="game">
        <div class="header">
            <div style="display:flex;align-items:center;">
                <div class="level-info">N√≠vel <span id="level">1</span></div>
                <div class="xp-bar"><div class="xp-fill" id="xp-fill"></div></div>
                <div class="xp-text" id="xp-text">0 / 100 XP</div>
            </div>
        </div>

        <button class="next-btn" id="next-btn">Pr√≥xima</button>
        <button class="save-score-btn" id="save-score-game">üíæ Salvar</button>

        <div class="hangman-container">
            <div class="hint" id="hint-text"></div>

            <svg class="hangman-svg" viewBox="0 0 220 280">
                <line x1="10" y1="270" x2="140" y2="270" stroke="white" stroke-width="6"/>
                <line x1="40" y1="270" x2="40" y2="20" stroke="white" stroke-width="6"/>
                <line x1="40" y1="20" x2="120" y2="20" stroke="white" stroke-width="6"/>
                <line x1="120" y1="20" x2="120" y2="60" stroke="white" stroke-width="6"/>
                <circle id="head" cx="120" cy="80" r="20" stroke="white" stroke-width="5" fill="none" opacity="0"/>
                <line id="body" x1="120" y1="100" x2="120" y2="180" stroke="white" stroke-width="5" opacity="0"/>
                <line id="left-arm" x1="120" y1="130" x2="90" y2="160" stroke="white" stroke-width="5" opacity="0"/>
                <line id="right-arm" x1="120" y1="130" x2="150" y2="160" stroke="white" stroke-width="5" opacity="0"/>
                <line id="left-leg" x1="120" y1="180" x2="90" y2="230" stroke="white" stroke-width="5" opacity="0"/>
                <line id="right-leg" x1="120" y1="180" x2="150" y2="230" stroke="white" stroke-width="5" opacity="0"/>
            </svg>

            <!-- PALAVRA DESCEU E N√ÉO SOBREPOE MAIS -->
            <div class="word-display" id="word-display"></div>

            <div class="boosts">
                <button class="boost-btn" id="reveal-btn">Revelar Letra (<span id="reveal-count">1</span>)</button>
                <button class="boost-btn" id="skip-btn">Pular Palavra (<span id="skip-count">1</span>)</button>
            </div>

            <div class="message" id="message"></div>

            <div class="keyboard" id="keyboard"></div>
        </div>
    </div>

    <script>
        const clickSound = new Audio('data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAIlYAAESsAAACABAAZGF0YQAAAAA=');
        const winSound   = new Audio('data:audio/wav;base64,UklGRl4AAABXQVZFZm10IBAAAAABAAEAIlYAAESsAAACABAAZGF0YQAAAAA=');
        const wrongSound = new Audio('data:audio/wav;base64,UklGRhwAAABXQVZFZm10IBAAAAABAAEARKwAAEzGAAACABAAZGF0YQAAAAA=');
        const levelUpSound = new Audio('data:audio/wav;base64,UklGRl4AAABXQVZFZm10IBAAAAABAAEAIlYAAESsAAACABAAZGF0YQAAAAA=');

        const allWords = [
            { word: "ZUMBI", hint: "L√≠der do maior quilombo" },
            { word: "DANDARA", hint: "Guerreira dos Palmares" },
            { word: "SACI", hint: "Menino de uma perna s√≥" },
            { word: "IARA", hint: "Sereia brasileira" },
            { word: "CURUPIRA", hint: "Protetor da floresta" },
            { word: "XANG√î", hint: "Orix√° do trov√£o" },
            { word: "OXUM", hint: "Rainha das √°guas doces" },
            { word: "IEMANJ√Å", hint: "M√£e do mar" },
            { word: "OGUM", hint: "Orix√° guerreiro" },
            { word: "OX√ìSSI", hint: "Ca√ßador sagrado" },
            { word: "AQUALTUNE", hint: "Princesa que fundou Palmares" },
            { word: "PEL√â", hint: "Rei do futebol brasileiro" },
            { word: "CAROLINA", hint: "Autora de Quarto de Despejo" },
            { word: "L√âLIA", hint: "Grande ativista negra" },
            { word: "CASTRO ALVES", hint: "Poeta do Navio Negreiro" },
            
            // Instrumentos Musicais
            { word: "BERIMBAU", hint: "Instrumento principal da capoeira" },
            { word: "ATABAQUE", hint: "Tambor usado no candombl√©" },
            { word: "PANDEIRO", hint: "Instrumento de samba e choro" },
            { word: "CU√çCA", hint: "Tambor que faz som agudo" },
            { word: "RECO RECO", hint: "Instrumento raspado com vara" },
            { word: "SURDO", hint: "Tambor grande do samba" },
            { word: "AGOG√î", hint: "Duas campanas de metal" },
            { word: "TIMBAL", hint: "Tambor de metal afinado" },
            { word: "AFOX√â", hint: "Chocalho de contas" },
            { word: "GANZ√Å", hint: "Chocalho cil√≠ndrico" },
            { word: "CAXIXI", hint: "Chocalho de palha" },
            { word: "TAMBOURIN", hint: "Pandeiro pequeno" },
            
            // Comidas T√≠picas
            { word: "ACARAJ√â", hint: "Bolinho baiano frito no dend√™" },
            { word: "VATAP√Å", hint: "Prato cremoso com camar√£o" },
            { word: "CARURU", hint: "Prato de quiabo refogado" },
            { word: "ABAR√Å", hint: "Acaraj√© cozido na folha" },
            { word: "COCADA", hint: "Doce de coco e a√ß√∫car" },
            { word: "PAMONHA", hint: "Doce de milho na palha" },
            { word: "MUNGUNZ√Å", hint: "Doce de milho com leite" },
            { word: "QUINDIM", hint: "Doce amarelo de coco" },
            { word: "FAROFA", hint: "Farinha temperada" },
            { word: "FEIJOADA", hint: "Prato com feij√£o preto" },
            { word: "BOB√ì", hint: "Prato de camar√£o com mandioca" },
            { word: "MANI√áOBA", hint: "Prato paraense com maniva" },
            { word: "XINXIM", hint: "Frango com amendoim" },
            { word: "SARAPATEL", hint: "Prato de mi√∫dos temperados" }
        ];

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        let words = shuffle([...allWords]);
        let currentIndex = 0;
        let level = 1;
        let xp = 0;
        let skips = 1;
        let reveals = 1;
        let playerName = '';
        let totalWordsCorrect = 0;
        let gameStartTime = Date.now();

        let currentWord = {};
        let displayedWord = [];
        let wrongGuesses = 0;
        const maxWrong = 6;
        const parts = ['head', 'body', 'left-arm', 'right-arm', 'left-leg', 'right-leg'];

        const levelEl = document.getElementById('level');
        const xpFill = document.getElementById('xp-fill');
        const xpText = document.getElementById('xp-text');
        const revealBtn = document.getElementById('reveal-btn');
        const skipBtn = document.getElementById('skip-btn');
        const revealCount = document.getElementById('reveal-count');
        const skipCount = document.getElementById('skip-count');
        const nextBtn = document.getElementById('next-btn');

        function updateUI() {
            levelEl.textContent = level;
            xpFill.style.width = xp + '%';
            xpText.textContent = `${xp} / 100 XP`;
            revealCount.textContent = reveals;
            skipCount.textContent = skips;
            revealBtn.disabled = reveals === 0;
            skipBtn.disabled = skips === 0;
        }

        function play(s) { s.currentTime = 0; s.play().catch(()=>{}); }

        // Fun√ß√£o para normalizar texto (remover acentos)
        function normalizeText(text) {
            return text.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toUpperCase();
        }

        // Sistema de Ranking
        function saveScore(name, level, wordsCorrect) {
            const scores = getScores();
            const score = {
                name: name,
                level: level,
                wordsCorrect: wordsCorrect,
                date: new Date().toLocaleDateString('pt-BR'),
                points: (level * 100) + (wordsCorrect * 10)
            };
            scores.push(score);
            scores.sort((a, b) => b.points - a.points);
            scores.splice(10); // Manter apenas top 10
            localStorage.setItem('hangmanScores', JSON.stringify(scores));
        }

        function getScores() {
            const scores = localStorage.getItem('hangmanScores');
            return scores ? JSON.parse(scores) : [];
        }

        function showRanking() {
            const scores = getScores();
            const rankingList = document.getElementById('ranking-list');
            
            if (scores.length === 0) {
                rankingList.innerHTML = '<p style="text-align:center;color:rgba(255,255,255,0.6);padding:2rem;">Nenhum score registrado ainda!</p>';
            } else {
                rankingList.innerHTML = scores.map((score, index) => `
                    <div class="ranking-item ${index < 3 ? 'top-3' : ''}">
                        <span class="ranking-position">#${index + 1}</span>
                        <span class="ranking-name">${score.name}</span>
                        <span class="ranking-score">Nv.${score.level} (${score.points}pts)</span>
                    </div>
                `).join('');
            }
            
            document.getElementById('ranking-modal').style.display = 'flex';
        }

        function showNameModal() {
            document.getElementById('final-level').textContent = level;
            document.getElementById('name-modal').style.display = 'flex';
            document.getElementById('player-name').focus();
        }

        function gameOver() {
            if (level > 1 || totalWordsCorrect > 0) { // Mostra modal se passou do n√≠vel 1 OU acertou qualquer palavra
                showNameModal();
            } else {
                // Se n√£o teve progresso, volta ao menu
                document.getElementById('menu').style.display = 'flex';
                document.getElementById('game').style.display = 'none';
                // Reset do jogo
                level = 1;
                xp = 0;
                skips = 1;
                reveals = 1;
                currentIndex = 0;
                words = shuffle([...allWords]);
                updateUI();
            }
        }

        function calculateXPGain() {
            return Math.max(10, 50 - (wrongGuesses * 8));
        }

        function levelUp() {
            level++;
            xp = 0;
            const reward = level % 2 === 0 ? 'skip' : 'reveal';
            if (reward === 'skip') skips++;
            else reveals++;
            play(levelUpSound);
            document.getElementById('message').innerHTML = `
                <div style="color:var(--gold);font-size:2.5rem;">N√çVEL UP!</div>
                Voc√™ agora √© N√≠vel ${level}!<br>
                +1 ${reward === 'skip' ? 'Pular Palavra' : 'Revelar Letra'}
            `;
            updateUI();
        }

        document.getElementById('play-btn').onclick = () => {
            play(clickSound);
            gameStartTime = Date.now();
            totalWordsCorrect = 0;
            document.getElementById('menu').style.display = 'none';
            document.getElementById('game').style.display = 'block';
            loadWord();
        };

        // Event listeners para ranking
        document.getElementById('ranking-btn').onclick = () => {
            play(clickSound);
            showRanking();
        };
        
        document.getElementById('save-score-game').onclick = () => {
            play(clickSound);
            showNameModal();
        };

        document.getElementById('close-ranking').onclick = () => {
            play(clickSound);
            document.getElementById('ranking-modal').style.display = 'none';
        };

        document.getElementById('save-score').onclick = () => {
            const name = document.getElementById('player-name').value.trim();
            if (name) {
                saveScore(name, level, totalWordsCorrect);
                play(clickSound);
                document.getElementById('name-modal').style.display = 'none';
                showRanking();
            } else {
                alert('Por favor, digite seu nome!');
            }
        };

        document.getElementById('skip-save').onclick = () => {
            play(clickSound);
            document.getElementById('name-modal').style.display = 'none';
            document.getElementById('menu').style.display = 'flex';
            document.getElementById('game').style.display = 'none';
            // Reset do jogo
            level = 1;
            xp = 0;
            skips = 1;
            reveals = 1;
            currentIndex = 0;
            words = shuffle([...allWords]);
            updateUI();
        };

        // Enter para salvar nome
        document.getElementById('player-name').onkeypress = (e) => {
            if (e.key === 'Enter') {
                document.getElementById('save-score').click();
            }
        };

        // Fechar modals clicando fora
        document.querySelectorAll('.modal').forEach(modal => {
            modal.onclick = (e) => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                    if (modal.id === 'name-modal') {
                        document.getElementById('skip-save').click();
                    }
                }
            };
        });

        nextBtn.onclick = () => { play(clickSound); nextWord(); };
        skipBtn.onclick = () => { 
            if(skips>0){ 
                skips--; 
                xp += 15; 
                checkLevelUp(); 
                play(clickSound); 
                nextWord(); 
                updateUI(); 
            } 
        };
        revealBtn.onclick = () => { 
            if(reveals>0){ 
                reveals--; 
                revealRandomLetter(); 
                updateUI(); 
                play(clickSound); 
            } 
        };

        function loadWord() {
            if (currentIndex >= words.length) {
                words = shuffle([...allWords]);
                currentIndex = 0;
            }
            currentWord = words[currentIndex];
            displayedWord = currentWord.word.split('').map(() => '_');
            wrongGuesses = 0;
            document.getElementById('hint-text').textContent = currentWord.hint;
            document.getElementById('word-display').textContent = displayedWord.join(' ');
            document.getElementById('message').textContent = '';
            nextBtn.style.display = 'none';
            parts.forEach(p => document.getElementById(p).setAttribute('opacity','0'));
            createKeyboard();
            updateUI();
        }

        function nextWord() {
            currentIndex++;
            loadWord();
        }

        function checkLevelUp() {
            if (xp >= 100) levelUp();
        }

        function revealRandomLetter() {
            const hidden = displayedWord.map((l,i) => l==='_' ? i : -1).filter(i => i>=0);
            if (hidden.length > 0) {
                const idx = hidden[Math.floor(Math.random()*hidden.length)];
                displayedWord[idx] = currentWord.word[idx];
                document.getElementById('word-display').textContent = displayedWord.join(' ');
            }
        }

        function createKeyboard() {
            const kb = document.getElementById('keyboard');
            kb.innerHTML = '';
            // Teclado com caracteres especiais + espa√ßo
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ√Ä√Å√Ç√É√á√â√ä√ç√ì√î√ï√ö ';
            letters.split('').forEach(l => {
                const btn = document.createElement('button');
                btn.className = 'key';
                btn.textContent = l === ' ' ? '‚ê£' : l; // Mostra s√≠mbolo visual para espa√ßo
                btn.onclick = () => guessLetter(l, btn);
                kb.appendChild(btn);
            });
        }

        function guessLetter(letter, btn) {
            play(clickSound);
            if (btn.classList.contains('used')) return;
            btn.classList.add('used');

            // Normalizar a letra clicada e a palavra para compara√ß√£o
            const normalizedLetter = normalizeText(letter);
            const normalizedWord = normalizeText(currentWord.word);
            
            let found = false;
            
            // Verificar se a letra (normalizada) existe na palavra
            if (normalizedWord.includes(normalizedLetter)) {
                btn.classList.add('correct');
                
                // Revelar todas as ocorr√™ncias da letra (tanto normal quanto acentuada)
                currentWord.word.split('').forEach((wordLetter, i) => {
                    if (normalizeText(wordLetter) === normalizedLetter) {
                        displayedWord[i] = wordLetter; // Mostra a letra original (com acento se houver)
                        found = true;
                    }
                });
                
                document.getElementById('word-display').textContent = displayedWord.join(' ');
                if (!displayedWord.includes('_')) win();
            } else {
                btn.classList.add('wrong');
                play(wrongSound);
                wrongGuesses++;
                document.getElementById(parts[wrongGuesses-1]).setAttribute('opacity','1');
                if (wrongGuesses === maxWrong) lose();
            }
        }

        function win() {
            const xpGain = calculateXPGain();
            totalWordsCorrect++;
            document.getElementById('message').innerHTML = `Parab√©ns! Acertou!<br>+${xpGain} XP (${wrongGuesses} erros)`;
            document.getElementById('message').style.color = 'var(--correct)';
            nextBtn.style.display = 'block';
            play(winSound);
            xp += xpGain;
            checkLevelUp();
            disableKeyboard();
            updateUI();
        }

        function lose() {
            document.getElementById('message').innerHTML = `Game Over!<br>Era: ${currentWord.word}`;
            document.getElementById('message').style.color = 'var(--wrong)';
            nextBtn.style.display = 'block';
            disableKeyboard();
            // Sempre mostra modal de nome ap√≥s 2 segundos se o jogador teve algum progresso
            setTimeout(() => {
                gameOver();
            }, 2000);
        }

        function disableKeyboard() {
            document.querySelectorAll('.key').forEach(k => k.style.cursor = 'not-allowed');
        }
    </script>
</body>
</html>
